{% extends "hyp/layout.html" %}
{% block content %}
  <h1>API Keys</h1>

  {% if perms.hyp.add_apikey %}
    <h2>Create API Key</h2>
  {% endif %}

  <form action="{% url 'create_api_key' %}" method="post">
    {% csrf_token %}
    <label for="api_key_label">Label:</label><br>
    <input type="text" id="api_key_label" name="api_key_label"><br>
    <input type="submit" value="Create">
  </form>

  <ul class="api-key-list">
  {% for api_key in api_keys %}
    <li> 
      <p>
        <span>
          {{ api_key.description }}
        </span>
        {% if api_key.is_active and perms.hyp.change_apikey%}
          <form action="{% url 'deactivate_api_key' api_key_id=api_key.id %}" method="patch" onsubmit="return confirm('This will break any API clients using this key. API keys cannot be reactivated. Are you sure?');">
            <input type="submit" value="Deactivate">
          </form>
        {% endif %}
      </p>
    </li>
  {% endfor %}
  </ul>
{% endblock %}
