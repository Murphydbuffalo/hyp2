{% extends "hyp/layout.html" %}
{% load static %}
{% block head_tags %}
  <script src="https://cdn.amcharts.com/lib/4/core.js"></script>
  <script src="https://cdn.amcharts.com/lib/4/charts.js"></script>
  <script src="https://cdn.amcharts.com/lib/4/themes/animated.js"></script>
  <script src={% static "js/experiment_chart.js" %}></script>
{% endblock %}

{% block content %}
  <h1>{{ experiment.description }} experiment</h1>
  <p id="total-interactions">
    {% if experiment.total_interactions > 0 %}
    {{ experiment.total_interactions }} unique participants.
    {% else %}
    No one has participated in this experiment yet.
    {% endif %}
  </p>
  <p id="uncertainty" class={{ experiment.uncertainty_style }}>
    Uncertainty level: {{ experiment.uncertainty_level  }}
  </p>

  <div id="traffic-split-chart"></div>

  <h2>Variants</h2>
  <div id="variants">
    {% for variant in experiment.variant_set.all %}
    <div class="variant-details">
      <h3>{{ variant.name }}</h3>
      {% if variant.num_interactions == 0 %}
      <p>No one has interacted with this variant yet.</p>
      {% else %}
      <p>Has received {% widthratio variant.traffic_split_to_date 0.01 1 %}% of traffic to date.</p>
      <p>{% widthratio variant.conversion_rate 1 100 %}% conversion rate</p>
      {% endif %}
    </div>
    {% endfor %}
  </div>

  {{ experiment.traffic_split_history|json_script:"traffic-split-data" }}
{% endblock %}
